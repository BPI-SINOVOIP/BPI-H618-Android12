<?xml version="1.0" encoding="UTF-8"?>
<!--
    The wizard:uris recorded here have the inconvenience of being generated by hand, but they allow
    for the full spread of launch flags (we need FLAG_ACTIVITY_NEW_TASK [0x10000000]), where the
    <intent> tag processed by Intent.parseIntent() does not.

    adb shell am to-intent-uri -a com.android.setupwizard.WELCOME -f 0x10000000 \-\-ez firstRun true
-->
<WizardScript xmlns:wizard="http://schemas.android.com/apk/res/com.google.android.setupwizard"
    wizard:version="2">

    <!-- Ask user if they want to migrate using usb. If the transferring process has already begun
        we will auto advance to usb_migration_after_add_account. Requires activation via Gservices
        flag [RECOMMENDED] -->
    <WizardAction id="usb_migration"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.USB_MIGRATION;end">
        <result wizard:name="result_usb_migration_with_account"
            wizard:resultCode="101"
            wizard:action="usb_migration_after_add_account" />
        <result
            wizard:resultCode="103"
            wizard:action="load_add_account_intent" />
        <result wizard:action="restore_choice" />
    </WizardAction>

    <WizardAction id="load_add_account_intent"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.LOAD_ADD_ACCOUNT_INTENT;B.showTapAndGo=false;end" />

    <WizardAction id="account_setup"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.ACCOUNT_SETUP;end">
        <result wizard:name="unintentional_cancel"
            wizard:resultCode="102"
            wizard:action="rollback_auth_early_update" />
        <result wizard:action="usb_migration_after_add_account" />
    </WizardAction>

    <!-- Script that includes steps to rollback auth early update [REQUIRED] -->
    <WizardAction id="rollback_auth_early_update"
      wizard:script="android.resource://com.allwinnertech.gmsintegration/raw/wizard_script_rollback_auth_early_update_flow">
        <result wizard:action="load_add_account_intent" />
    </WizardAction>

    <!-- Relaunch into usb migration flow -->
    <WizardAction id="usb_migration_after_add_account"
        wizard:uri="intent:#Intent;action=com.google.android.setupwizard.D2D_MIGRATION_AFTER_ACCOUNT;end">
        <result wizard:action="restore_with_usb_flow" />
    </WizardAction>


    <!-- Choose device restoration flow [RECOMMENDED, CUSTOMIZABLE] -->
    <WizardAction id="restore_choice"
        wizard:uri="intent:#Intent;action=com.android.setupwizard.RESTORE_CHOICE;end">
        <result wizard:name="d2d"
            wizard:resultCode="101"
            wizard:action="restore_with_device_flow" />
        <result wizard:name="ios_restore"
            wizard:resultCode="102"
            wizard:action="restore_with_ios_flow" />
        <result wizard:name="dont_copy"
                wizard:resultCode="103"
                wizard:action="setup_as_new_flow" />
        <result wizard:action="restore_with_account_flow" />
    </WizardAction>

    <!-- Set up without restoring from old device [RECOMMENDED] -->
    <WizardAction id="setup_as_new_flow"
      wizard:script="android.resource://com.allwinnertech.gmsintegration/raw/wizard_script_setup_as_new_flow">
        <result wizard:action="END_OF_SCRIPT" />
    </WizardAction>


    <!-- Set up using USB transfer [RECOMMENDED] -->
    <WizardAction id="restore_with_usb_flow"
      wizard:script="android.resource://com.allwinnertech.gmsintegration/raw/wizard_script_restore_with_usb_flow">
        <result wizard:action="END_OF_SCRIPT" />
    </WizardAction>


    <!-- Restore user data and apps from servers [REQUIRED] -->
    <WizardAction id="restore_with_account_flow"
      wizard:script="android.resource://com.allwinnertech.gmsintegration/raw/wizard_script_restore_with_account_flow">
        <result wizard:action="END_OF_SCRIPT" />
    </WizardAction>


    <!-- Restore user data and apps from another Android [RECOMMENDED] -->
    <WizardAction id="restore_with_device_flow"
      wizard:script="android.resource://com.allwinnertech.gmsintegration/raw/wizard_script_restore_with_device_flow">
        <result wizard:action="END_OF_SCRIPT" />
    </WizardAction>


    <!-- Restore user data and apps from an iOS device [RECOMMENDED] -->
    <WizardAction id="restore_with_ios_flow"
      wizard:script="android.resource://com.allwinnertech.gmsintegration/raw/wizard_script_restore_with_ios_flow">
        <result wizard:action="END_OF_SCRIPT" />
    </WizardAction>


    <!-- Labeled end of script (for branching) [RECOMMENDED, CUSTOMIZABLE] -->
    <WizardAction id="END_OF_SCRIPT" />
</WizardScript>
